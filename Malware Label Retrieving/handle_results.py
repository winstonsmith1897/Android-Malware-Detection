import connect_fortiguard 

def handle():
	file = open('/mnt/d/results.txt', 'r')
	lines = file.readlines()
	families = []
	family_types = []
	hashes = []
	correspondence = []
	for line in lines:
		fam = line[33::]
		if 'SINGLETON' not in fam:
			family = fam.replace('\n', '')
			families.append(family)
			hash = line[0:32]
			hashes.append((hash, family))

	for fams in families:
		if fams not in family_types:
			family_types.append(fams)

	for elem in family_types:
		virus, label = connect_fortiguard.classification(elem)
		correspondence.append((virus, label))
	create_dataset(hashes, correspondence)

def create_dataset(hashes, correspondence):
	final_list = []
	for hash, family in hashes:
		for virus, label in correspondence:
			if family == virus:
				final_list.append((hash, label))
	print(final_list)
	list_dataset(final_list)

def list_dataset(final_list):
	file = open('/mnt/d/prova_LABELED_DATASET.txt', 'a') for hash, label in 
	final_list:
		file.write('VirusShare_' + hash + '        ' + label + '\n')
	print('+++++++++++++++++++++++++++++++++++\n\nThe DATASET has been labeled succesfully')
